В момент сброса микросхемы, значения на выводах микросхемы GPIO0 сохраняются в регистре SYS_BOOT_CFG. В дальнейшем, эти значения будут использоваться ПЗУ начальной загрузки и также доступны для пользовательских программ. Далее по тексту - BOOTMx, где x номер бита.

В РСПСА реализовано два режима загрузки: 

* Загрузка с использованием ПЗУ начальной загрузки (BOOTROM);
* Прямое исполнение кода из внешней памяти, подключенной к интерфейсу EMI (NOR).

Режим загрузки определяется значением поля BOOTM7 (GPIO0_7) регистра SYS_BOOT_CFG (см. <<tbl_sys_boot_cfg>>)

После снятия активного уровня сигнала сброса с РСПСА процессорное ядро (ПЯ) выполняет обращение на чтение первой исполняемой команды, расположенной по эффективному адресу 0xFFFFFFFC. Данное обращение попадает в блок TLB, который, после сброса, по умолчанию, настроен на трансляцию эффективных адресов в физические адреса только в пределах одной страницы объемом 4 Кбайт в диапазоне адресов {0x3FF_FFFFF000: 0x3FF_FFFFFFFC}. Поэтому, эффективный адрес 0хFFFFFFFC преобразуется блоком TLB в физический адрес 0x3FF_FFFFFFFC, который выдается на центральный коммутатор шины PLB6.

Дальнейшие действия по загрузке определяются значением конфигурационного бита BOOTM7:

* Если SCTL.BOOTM7=0, то выполняется прямая загрузка из NOR памяти. Обращения процессора перенаправляются в slave-сегмент № 0, к которому, через контроллер шины внешней памяти (EMI), подключена NOR-память;

* Если SCTL.BOOTM7=1, то процессор исполняет встроенный bootrom. Обращения процессорного ядра перенаправляются в slave-сегмент № 1, к которому подключены встроенная статическая память IM0 и встроенное загрузочное ПЗУ (BOOTROM).

Поля BOOTM0 – BOOTM6 влияют на поведение встроенного загрузочного ПЗУ. 

NOTE: Загрузка с использованием начального загрузчика рекомендуется к применению при отсутствии специальных требований к алгоритму загрузки. ПЗУ начальной загрузки обеспечивает подробную диагностику через интерфейс последовательного порта, производит проверку целостности исполняемого кода, и обладает множеством других функций, упрощающих работу на раннем этапе. 

.Описание значения полей регистра SYS_BOOT_CFG
[#tbl_sys_boot_cfg,cols="10,45,45",options="header"]
|===
|BOOTM/GPIO
|Режим прямой загрузки из внешней ПЗУ-памяти
(Slave Segment 0)
|Режим загрузки с использованием ПЗУ начальной загрузки
(Slave Segment 2)

|BOOTM0/ GPIO0_0
|Не используется, значение при сбросе программно доступно в SCTL для пользовательского кода
|Процедура самотестирования при старте.

0 – не запускать

1 – запускать

|BOOTM1/GPIO0_1
|Не используется, значение при сбросе программно доступно в SCTL для пользовательского кода
|Хост-режим загрузки.

0 – нормальная загрузка

1 – хост-режим

В начале загрузки, после считывания значения на входе, линия конфигурируется на выход в состояние 0 и переключается в состояние 1 при входе в хост-режим (в случае загрузки в хост-режиме или невозможности загрузиться ни с одного источника)


|BOOTM2/ GPIO0_2
|Не используется, значение при сбросе программно доступно в SCTL для пользовательского кода
| Скорость UART для диагностических сообщений первичного загрузчика (см. таблицу <<tbl_boot_uart_speed>>)


|BOOTM3/ GPIO0_3
|Не используется, значение при сбросе программно доступно в SCTL для пользовательского кода
|Вывод используется в виде сигнала Card Detect для SDIO

0 – карта присутствует

1 – карта отсутствует

|BOOTM4/GPIO0_4
|Не используется, значение при сбросе программно доступно в SCTL для пользовательского кода
|Скорость UART для диагностических сообщений первичного загрузчика (см. таблицу <<tbl_boot_uart_speed>>)

|BOOTM5/GPIO0_5
|Зарезервирован
|Зарезервирован

|BOOTM6/ GPIO0_6
|Начальное значение режима ECC для внешней памяти (NOR, SRAM)

1 – Не задействовать

0 – Задействовать (Хэмминг, 32 бита, детектирование 
двух, исправление одной ошибки)

|Начальное значение режима ECC для внешней памяти (NOR, SRAM)

1 – Не задействовать

0 – Задействовать (Хэмминг, 32 бита, детектирование двух, исправление одной ошибки)

|BOOTM7/ GPIO0_7
|0 – Режим прямой загрузки из NOR памяти.

1 – Режим загрузки с использованием ПЗУ начальной загрузки

|0 – Режим загрузки из внешней ПЗУ-памяти.

1 – Режим загрузки с использованием ПЗУ начальной загрузки
|=== 


.Скорость UART для вывода диагностических сообщений
[#tbl_boot_uart_speed,cols="10,10,10",options="header"]
|===
|BOOTM4
|BOOTM2
|Скорость UART

|0|0|115200
|0|1|625000
|1|0|9600
|1|1|19200

|=== 
